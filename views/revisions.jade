//Page RÃ©visions

include layout.jade
 
body(id="home-page")
  header
      include navbar.jade
  script(type="text/javascript").
    function inverseItemState(itemId,matiereName){
      $.ajax({
      url: '/matiere/'+matiereName+'/revisions/check/'+itemId,
      type: 'PATCH',
      success: function(data) {
        location.reload(true)
      }
      });
      return false;
    }
    function deleteColonne(itemId,libQuizz,matiereName){
        $.ajax({
        url: '/matiere/'+matiereName+'/revisions/'+libQuizz+'/colonne/'+itemId,
        type: 'DELETE',
        success: function(data) {
          location.reload(true)
        }
        });
        return false;
      }
    function deleteLigne(itemId,libQuizz,matiereName){
        $.ajax({
        url: '/matiere/'+matiereName+'/revisions/'+libQuizz+'/ligne/'+itemId,
        type: 'DELETE',
        success: function(data) {
          location.reload(true)
        }
        });
        return false;
      }
  
  .container.bg-light.mt-5
    table
      thead
        tr
          th
          each colonne in colonneList
            th #{colonne.dataValues.LibColonne}
              strong(onclick="deleteColonne(#{colonne.dataValues.id},'#{nomMatiere}')") &#10008;
        
          th
            form.form-inline(action="/matiere/#{nomMatiere}/revisions/newColonne" method='post') 
              .form-group
                label(for="ajout")   
                input(type="text" name='libelle' class="form-control" placeholder="Ajouter une colonne" required) 
                button(type="submit" class="btn btn-info") +
      tbody
        - for(var i = 0; i < ligneList.length; i++) {
            tr  
              th #{ligneList[i].dataValues.libLigne}
                strong(onclick="deleteLigne(#{ligneList[i].dataValues.id},'#{nomMatiere}')") &#10008;
        
              - for(var j = 0; j < colonneList.length; j++){
                -if(caseList[i][j].dataValues.estCoche){
                   td(onclick="inverseItemState(#{caseList[i][j].dataValues.id},'#{nomMatiere}')").centerText &#10008;
                -}
                -else{
                  td(onclick="inverseItemState(#{caseList[i][j].dataValues.id},'#{nomMatiere}')")
                -}
              - }
        - }
        th
          form.form-inline(action="/matiere/#{nomMatiere}/revisions/newLigne" method='post') 
            .form-group
              label(for="ajout")   
              input(type="text" name='libelle' class="form-control" placeholder="Ajouter une ligne" required) 
              button(type="submit" class="btn btn-info") +


  footer
    include footer.jade
